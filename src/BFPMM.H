#ifndef BFPMM_H
#define BFPMM_H

#include <RcppArmadillo.h>
#include <cmath>
#include <splines2Armadillo.h>
#include "Distributions.H"
#include "UpdateClassMembership.H"
#include "UpdatePi.H"
#include "UpdatePhi.H"
#include "UpdateDelta.H"
#include "UpdateA.H"
#include "UpdateGamma.H"
#include "UpdateNu.H"
#include "UpdateTau.H"
#include "UpdateSigma.H"
#include "UpdateChi.H"
#include "CalculateLikelihood.H"


Rcpp::List BFPMM(const arma::field<arma::vec>& y_obs,
                 const arma::field<arma::vec>& t_obs,
                 const double& n_funct,
                 const int& thinning_num,
                 const int& K,
                 const int& P,
                 const int& M,
                 const int& tot_mcmc_iters,
                 const int& r_stored_iters,
                 const arma::vec& c,
                 const double& b,
                 const double& nu_1,
                 const double& alpha1l,
                 const double& alpha2l,
                 const double& beta1l,
                 const double& beta2l,
                 const double& a_Z_PM,
                 const double& a_pi_PM,
                 const double& var_alpha3,
                 const double& var_epsilon1,
                 const double& var_epsilon2,
                 const double& alpha,
                 const double& beta,
                 const double& alpha_0,
                 const double& beta_0,
                 const std::string directory);

Rcpp::List BFPMM_Templadder(const arma::field<arma::vec>& y_obs,
                            const arma::field<arma::vec>& t_obs,
                            const double& n_funct,
                            const int& K,
                            const int& P,
                            const int& M,
                            const int& tot_mcmc_iters,
                            const int& r_stored_iters,
                            const arma::vec& c,
                            const double& b,
                            const double& nu_1,
                            const double& alpha1l,
                            const double& alpha2l,
                            const double& beta1l,
                            const double& beta2l,
                            const double& a_Z_PM,
                            const double& a_pi_PM,
                            const double& var_alpha3,
                            const double& var_epsilon1,
                            const double& var_epsilon2,
                            const double& alpha,
                            const double& beta,
                            const double& alpha_0,
                            const double& beta_0,
                            const double& beta_N_t,
                            const int& N_t);

Rcpp::List BFPMM_MTT(const arma::field<arma::vec>& y_obs,
                     const arma::field<arma::vec>& t_obs,
                     const double& n_funct,
                     const int& thinning_num,
                     const int& K,
                     const int& P,
                     const int& M,
                     const int& tot_mcmc_iters,
                     const int& r_stored_iters,
                     const int& n_temp_trans,
                     const arma::vec& c,
                     const double& b,
                     const double& nu_1,
                     const double& alpha1l,
                     const double& alpha2l,
                     const double& beta1l,
                     const double& beta2l,
                     const double& a_Z_PM,
                     const double& a_pi_PM,
                     const double& var_alpha3,
                     const double& var_epsilon1,
                     const double& var_epsilon2,
                     const double& alpha,
                     const double& beta,
                     const double& alpha_0,
                     const double& beta_0,
                     const std::string directory,
                     const double& beta_N_t,
                     const int& N_t);

Rcpp::List BFPMM_Nu_Z(const arma::field<arma::vec>& y_obs,
                      const arma::field<arma::vec>& t_obs,
                      const double& n_funct,
                      const int& K,
                      const int& P,
                      const int& M,
                      const int& tot_mcmc_iters,
                      const arma::vec& c,
                      const double& b,
                      const double& nu_1,
                      const double& alpha1l,
                      const double& alpha2l,
                      const double& beta1l,
                      const double& beta2l,
                      const double& a_Z_PM,
                      const double& a_pi_PM,
                      const double& var_alpha3,
                      const double& var_epsilon1,
                      const double& var_epsilon2,
                      const double& alpha,
                      const double& beta,
                      const double& alpha_0,
                      const double& beta_0);

Rcpp::List BFPMM_Theta(const arma::field<arma::vec>& y_obs,
                       const arma::field<arma::vec>& t_obs,
                       const double& n_funct,
                       const int& K,
                       const int& P,
                       const int& M,
                       const int& tot_mcmc_iters,
                       const arma::vec& c,
                       const double& b,
                       const double& nu_1,
                       const double& alpha1l,
                       const double& alpha2l,
                       const double& beta1l,
                       const double& beta2l,
                       const double& a_Z_PM,
                       const double& a_pi_PM,
                       const double& var_alpha3,
                       const double& var_epsilon1,
                       const double& var_epsilon2,
                       const double& alpha,
                       const double& beta,
                       const double& alpha_0,
                       const double& beta_0,
                       const arma::mat& Z_est,
                       const arma::mat& nu_est);

Rcpp::List BFPMM_MTT_warm_start(const arma::field<arma::vec>& y_obs,
                                const arma::field<arma::vec>& t_obs,
                                const double& n_funct,
                                const int& thinning_num,
                                const int& K,
                                const int& P,
                                const int& M,
                                const int& tot_mcmc_iters,
                                const int& r_stored_iters,
                                const int& n_temp_trans,
                                const arma::vec& c,
                                const double& b,
                                const double& nu_1,
                                const double& alpha1l,
                                const double& alpha2l,
                                const double& beta1l,
                                const double& beta2l,
                                const double& a_Z_PM,
                                const double& a_pi_PM,
                                const double& var_alpha3,
                                const double& var_epsilon1,
                                const double& var_epsilon2,
                                const double& alpha,
                                const double& beta,
                                const double& alpha_0,
                                const double& beta_0,
                                const std::string directory,
                                const double& beta_N_t,
                                const int& N_t,
                                const arma::mat& Z_est,
                                const arma::vec& pi_est,
                                const double& alpha_3_est,
                                const arma::vec& delta_est,
                                const arma::cube& gamma_est,
                                const arma::cube& Phi_est,
                                const arma::vec& A_est,
                                const arma::mat& nu_est,
                                const arma::vec& tau_est,
                                const double& sigma_est,
                                const arma::mat& chi_est);
#endif
